export default class InventorySystem{ constructor(scene){ this.scene=scene; this.state=scene.registry.get('state'); this.itemsDef=scene.cache.json.get('items'); } add(id){ this.state.inventory.push(id); const def=this.itemsDef[id]; if(def){ if(def.type==="weapon"||def.type==="shield"){ this.equip(id);} } this._save(); } remove(id){ const i=this.state.inventory.indexOf(id); if(i>=0){ this.state.inventory.splice(i,1); this._save(); } } equip(id){ const def=this.itemsDef[id]; if(!def) return; const p=this.state.player; p.atk=(p.atk||0)+(def.atk||0); p.def=(p.def||0)+(def.def||0); if(def.elem) p.elem=def.elem; this._save(); } _save(){ this.scene.registry.get('save').save(this.state); } }